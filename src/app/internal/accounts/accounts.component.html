<app-progress-bar *ngIf="isApiCalling"></app-progress-bar>
<div class="heading-pannel">
    <div class="component-heading">
        <span>Accounts</span>
    </div>
    <div class="component-btn">
        <button (click)="editAccounts()" class="btn">Add Account</button>
    </div>
</div>

<div class="sub-compo-wrap">
    <div class="white-box">
        <nav class="asset-main-tab" *ngIf="accountTypeList.length == 0">
            <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                <a *ngFor="let data of [1,2,3,4,5];" style="cursor: pointer; width: 78px;" class="nav-item nav-link"
                    id="nav-home-tab" data-toggle="tab" role="tab" aria-controls="nav-home" aria-selected="true">
                    <span style="position: relative;">
                        <ngx-shimmer-loading [shape]="'rect'" [width]="'100px'" [height]="'20px'">
                        </ngx-shimmer-loading>
                    </span>
                    <span class="balance-btn">
                        <ngx-shimmer-loading [shape]="'rect'" [width]="'50px'" [height]="'10px'">
                        </ngx-shimmer-loading>
                    </span>
                </a>
            </div>
        </nav>

        <nav class="asset-main-tab" *ngIf="accountTypeList.length > 0">
            <div slickContainer #slickController="slick" [slickConfig]="config" class="nav nav-tabs nav-fill"
                id="nav-tab" role="tablist">
                <a slickItem *ngFor="let data of accountTypeList; let i = index" style="cursor: pointer; width: 78px;"
                    class="nav-item nav-link" [ngClass]="{ 'active' : isSelected == i }" id="nav-home-tab"
                    data-toggle="tab" role="tab" aria-controls="nav-home" aria-selected="true"
                    (click)="getType(data._id,i)">
                    <span style="position: relative;">
                        {{data.name }}
                        <span *ngIf="!data.default" style="position: absolute;right: -18px;">
                            <i (click)="deleteAccount(data._id,data.name,'deleteAccountType')"><img
                                    style="font-size: 13px;" src="../../../assets/images/delete-trash.svg"></i>
                        </span>
                    </span>

                    <span (click)="getType(data._id,i)" class="balance-btn">Bal:
                        ${{data.currentBalance}}</span></a>
            </div>
        </nav>
        <div style="padding:20px;" class="row">
            <div class="col-8 col-md-8 col-lg-8 scroller-class">
                <ng-container *ngIf="isShimmerloading">
                    <div *ngFor="let shimmer of [1,2,3,4,5,6,7,8,9,10]">
                        <div class="shimmer">
                            <ngx-shimmer-loading [shape]="'circle'" [width]="'50px'"></ngx-shimmer-loading>
                        </div>
                        <div class="shimmer">
                            <ngx-shimmer-loading [shape]="'rect'" [width]="'500px'" [height]="'50px'">
                            </ngx-shimmer-loading>
                        </div>
                    </div>
                </ng-container>

                <ng-container *ngIf="!isShimmerloading">
                    <div *ngFor="let data of accountList; let i = index" id="accountList{{i}}"
                        [ngClass]="{ 'active-step' : isRecordSelected == i }" class="editable-account"
                        (click)="recordSelected(i,data._id)">
                        <div class="number">
                            <span><img style="width: 32px;" src="{{data.icon}}"></span></div>
                        <div class="account-type"><span>{{ data.name }}</span></div>
                        <a class="view-btn">
                            <img style="margin-left: -57px;" *ngIf="data.isViewAmount" (click)="toggleAmount(i)"
                                src="../../../assets/images/view-eye.svg">
                            <img style="margin-left: -57px;width: 22px;" *ngIf="!data.isViewAmount"
                                (click)="toggleAmount(i)" src="../../../assets/images/close-eyes.svg">
                        </a>
                        <div class="pricing-icon">
                            <span class="price" *ngIf="!data.isViewAmount">${{data.currentBalance}}</span>
                            <span class="price" *ngIf="data.isViewAmount">*******</span>
                        </div>
                        <div class="action-tab-main">
                            <a style="cursor: pointer;" (click)="editAccounts(data)" class="edit-btn" title="edit">
                                <img src="../../../assets/images/edit-pencil.svg">
                            </a>
                            <a class="delete-btn" href="javascript:;" style="cursor: pointer;"
                                (click)="deleteAccount(data._id,data.name,'deleteAccount')" title="edit">
                                <img src="../../../assets/images/delete-trash.svg">
                            </a>
                        </div>

                    </div>
                </ng-container>

                <div style="display: flex;float: right;" *ngIf="resultsLength > 10">
                    <mat-paginator (page)="pageChange($event)" [length]="resultsLength" [pageSize]="10">
                    </mat-paginator>
                </div>
            </div>
            <div class="col-4 col-md-4 col-lg-4">
                <div class="list-main-filter">
                    <nav class="asset-main-tab">
                        <div class="nav nav-tabs nav-fill" id="nav-tab" role="tablist">
                            <a class="nav-item nav-link active list-btn" id="nav-home-tab" data-toggle="tab"
                                href="#nav-list-tab" role="tab" aria-controls="nav-home" aria-selected="true">List</a>
                            <a class="nav-item nav-link summary-btn" id="nav-profile-tab"
                                (click)="getSummaryDetails('Expanse')" data-toggle="tab" href="#nav-summary-tab"
                                role="tab" aria-controls="nav-profile" aria-selected="false">Summary</a>
                        </div>
                        <div class="filter-btn-group">
                            <a href="#" class="btn filter-btn" title="Summary">
                                <img src="../../../assets/images/fillter.svg">
                            </a>
                        </div>
                    </nav>
                    <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
                        <div class="tab-pane fade show active" id="nav-list-tab" role="tabpanel"
                            aria-labelledby="nav-list-tab">
                            <div class="accordian-main">
                                <mat-accordion>
                                    <mat-expansion-panel *ngFor="let ad of accountDetails" expanded="step === 0"
                                        (opened)="setStep(0)">
                                        <mat-expansion-panel-header>
                                            <mat-panel-title>
                                                {{ad._id.month}}/{{ad._id.year}}
                                            </mat-panel-title>
                                            <mat-panel-description>
                                                <span class="red-color">$ 120.00</span>
                                            </mat-panel-description>
                                        </mat-expansion-panel-header>

                                        <div *ngFor="let d of ad.data" class="inner-expansion-main">
                                            <div class="inner-sub-left">
                                                <div class="main-strips">
                                                    <div class="holder-name">{{d.accountId.name}}</div>
                                                    <div *ngIf="d.transactionType == 'IN'"
                                                        class="price-tag green-color">$ {{d.amount}}</div>
                                                    <div *ngIf="d.transactionType == 'OUT'" class="price-tag red-color">
                                                        $ {{d.amount}}</div>
                                                </div>
                                                <div class="main-strips">
                                                    <div class="date-and-time">{{d.createdAt | date}}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </mat-expansion-panel>
                                </mat-accordion>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="nav-summary-tab" role="tabpanel"
                            aria-labelledby="nav-summary-tab">
                            <div class="summary-charts-main">
                                <div class="item left-charts">
                                    <canvas width="150px" height="150px" baseChart chartType="doughnut"
                                        [data]="doughnutChartData" [labels]="doughnutChartLabels" [legend]="false"
                                        [colors]="donutColors">
                                    </canvas>
                                </div>
                                <div class="right-col-charts">
                                    <div class="strips-main"
                                        [ngStyle]="{'border': !isAccountSummaryType ?  '1px solid #FD4755':''}"
                                        (click)="getSummaryDetails('Expanse')">
                                        <span class="sub-heading red">Expanse</span>
                                        <span class="priceing-main red">${{accountSummary.expenseTotal}}</span>
                                    </div>
                                    <div class="strips-main"
                                        [ngStyle]="{'border': isAccountSummaryType ?  '1px solid #27AE60':''}"
                                        (click)="getSummaryDetails('Income')">
                                        <span class="sub-heading income green">Income</span>
                                        <span class="priceing-main green">$ {{accountSummary.incomeTotal}}</span>
                                    </div>
                                </div>
                            </div>
                            <!------------------------after-charts------------------------------------>
                            <div class="after-charts-main">
                                <div class="after-charts-strips-main" *ngFor="let data of accountSummaryData">
                                    <div class="comm-col first-col">{{data.name}}</div>
                                    <div class="comm-col red second-col">$ {{data.amount}}</div>
                                    <div class=" comm-col third-col"> {{data.percentage}}%</div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="fixed-foot total-expanse-panal-bottom-main">
    <div class="inner-expanse-panal-main">
        <div class="boxes">
            <span class="label red-total-expanse">Total Expanse : </span>
            <span class="value red-total-expanse">${{accountSummary.expenseTotal}}</span>
        </div>
        <div class="boxes">
            <span class="label green-cleared">Total Income : </span>
            <span class="value green-cleared">${{accountSummary.incomeTotal}}</span>
        </div>
        <div class="boxes">
            <span class="label">Total Balance : </span>
            <span class="value">$00</span>
        </div>
        <div class="boxes">
            <span class="label">Total Cleared Balance : </span>
            <span class="bold value">$00</span>
        </div>
    </div>
</div>